<div class="top-row navbar bg-primary" style="padding:0">
    <h4 class="text-center font-weight-bold"><a href="/Home/Index" class="stretched-link">Target Hound</a></h4>
</div>
<div class="@NavMenuCssClass= bg-primary overflow-auto vh-100" @onclick="ToggleNavMenu">
    <ul class="nav flex-column bg-primary">
        <li class="">
            <NavLink class="dropdown" @onclick="ToggleMenu">
                <a class="btn btn-primary dropdown-toggle btn-block" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Planning</a>
            </NavLink>
            @if (showMenu)
            {
                <NavLink class="nav-link">
                    <span class="btn btn-primary btn-block dropdown-toggle" aria-hidden="true" @onclick="ShowCollar">Create Collar</span>
                </NavLink>
                @if (this.showCollar)
                {
                    <TargetHound.Blazor.Pages.AddCollar />
                }
                <NavLink class="nav-link">
                    <span class="btn btn-primary btn-block dropdown-toggle" aria-hidden="true" @onclick="ShowTarget">Create Target</span>
                </NavLink>
                @if (this.showTarget)
                {
                    <CascadingValue Value="this.RefreshIsRequested">
                        <TargetHound.Blazor.Pages.AddTarget />
                    </CascadingValue>
                }
                <NavLink class="nav-link">
                    <span class="btn btn-primary btn-block dropdown-toggle" aria-hidden="true" @onclick="ShowBorehole">Create Borehole</span>
                </NavLink>
                @if (showBorehole)
                {
                    <CascadingValue Value="this.RefreshIsRequested">
                        <TargetHound.Blazor.Pages.AddBorehole Refresh="@this.Refresh" />
                    </CascadingValue>
                }
            }
        </li>

        <li class="">
            <NavLink class="dropdown" href="/Save">
                <a class="btn btn-primary btn-block" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Save</a>
            </NavLink>
        </li>
        <li class="">
            <NavLink class="dropdown" href="/Export">
                <a class="btn btn-primary btn-block dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Export</a>
            </NavLink>
        </li>
    </ul>
</div>

@code {
    private bool collapseNavMenu = true;
   
    private bool showMenu;
    
    private bool showBorehole;
    
    private bool showTarget;
    
    private bool showCollar;

    private string NavMenuCssClass => collapseNavMenu ? "collapse" : null;

    protected bool RefreshIsRequested { get; set; } = false;

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

    public void ToggleMenu()
    {
        this.showMenu = !this.showMenu;
    }

    public void ShowBorehole()
    {
        this.showBorehole = !this.showBorehole;
    }

    public void ShowCollar()
    {
        this.showCollar = !this.showCollar;
    }

    public void ShowTarget()
    {
        this.showTarget = !this.showTarget;
    }

    public void Refresh(bool refresh)
    {
        if (refresh)
        {
            this.RefreshIsRequested = !refresh;
            this.StateHasChanged();
        }
    }
}
